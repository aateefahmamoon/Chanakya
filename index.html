<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Indian Government Schemes Portal</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f9ff;
      color: #333;
    }

    header {
      background-color: #0078d7;
      color: white;
      text-align: center;
      padding: 1.5rem 0;
      font-size: 1.8rem;
      font-weight: bold;
      letter-spacing: 1px;
    }

    .lang-container {
      margin-top: 10px;
    }

    .lang-btn {
      background: white;
      color: #0078d7;
      border: 1px solid #0078d7;
      border-radius: 5px;
      padding: 5px 12px;
      margin: 0 5px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .lang-btn:hover {
      background: #005a9e;
      color: white;
      border-color: #005a9e;
    }

    .lang-btn.active {
      background: #0078d7;
      color: white;
    }

    .lang-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    section {
      max-width: 900px;
      margin: 2rem auto;
      padding: 2rem;
      background: white;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    h2 {
      color: #0078d7;
      border-left: 5px solid #0078d7;
      padding-left: 10px;
    }

    p,
    li {
      line-height: 1.6;
      font-size: 1.05rem;
      margin-top: 10px;
    }

    ul {
      padding-left: 20px;
    }

    .hero {
      background: linear-gradient(to right, #0078d7, #00a2ff);
      color: white;
      text-align: center;
      padding: 3rem 2rem;
      border-radius: 0 0 50px 50px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .hero h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }

    .hero p {
      font-size: 1.2rem;
      max-width: 700px;
      margin: 0 auto;
    }

    footer {
      background-color: #0078d7;
      color: white;
      text-align: center;
      padding: 1rem;
      margin-top: 2rem;
      font-size: 0.9rem;
    }

    .highlight {
      color: #0078d7;
      font-weight: bold;
    }

    .loading {
      opacity: 0.5;
      font-style: italic;
    }

    /* Floating chatbot button */
    #chatbot-btn {
      position: fixed;
      bottom: 28px;
      right: 28px;
      width: 54px;
      height: 54px;
      background: #128c7e;
      color: #fff;
      font-size: 2.2rem;
      border-radius: 50%;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25);
      cursor: pointer;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    /* Chatbot popup styling */
    #chatbot-popup {
      display: none;
      position: fixed;
      bottom: 92px;
      right: 28px;
      width: 320px;
      max-width: 95vw;
      background: #fff;
      box-shadow: 0 8px 28px rgba(0, 0, 0, 0.22);
      border-radius: 15px;
      z-index: 9999;
      flex-direction: column;
      overflow: hidden;
    }

    /* Header */
    #chatbot-header {
      background: #128c7e;
      color: #fff;
      padding: 0.7rem 1rem;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* Chat area */
    #chatbot-chat-area {
      padding: 1rem;
      height: 200px;
      overflow-y: auto;
      font-size: 1rem;
      border-bottom: 1px solid #eee;
      background: #f9f9f9;
    }

    /* Input field and send button */
    #chatbot-input {
      border: none;
      padding: 0.65rem;
      width: 68%;
      margin: 0.6em;
      border-radius: 10px;
      background: #f4f9ff;
      font-size: 1em;
    }

    #chatbot-send {
      background: #128c7e;
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 0.6em 1.2em;
      cursor: pointer;
      font-weight: bold;
      margin-bottom: 0.6em;
      transition: background 0.2s;
    }

    #chatbot-send:hover {
      background: #005a9e;
    }

    /* Close button */
    #chatbot-close {
      cursor: pointer;
      font-size: 1.5em;
    }
  </style>
</head>

<body>
  <header>
    Indian Government Schemes Portal
    <div class="lang-container">
      <button id="en-btn" class="lang-btn active">English</button>
      <button id="hi-btn" class="lang-btn">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
      <button id="te-btn" class="lang-btn">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</button>
      <button id="mr-btn" class="lang-btn">‡§Æ‡§∞‡§æ‡§†‡•Ä</button>
      <button id="kn-btn" class="lang-btn">‡≤ï‡≤®‡≥ç‡≤®‡≤°</button>
      <button id="ta-btn" class="lang-btn">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
    </div>
  </header>

  <div class="hero">
    <h1 class="translatable">Empowering Citizens Through Awareness</h1>
    <p class="translatable">
      Discover, learn, and benefit from government schemes designed to support education, health,
      business, and social welfare across India.
    </p>
  </div>

  <section>
    <h2 class="translatable">About the Portal</h2>
    <p class="translatable">Our platform provides a simplified and accessible way for citizens to explore various Indian
      Government Schemes. Instead of searching through multiple sites and documents, users can view key information like
      eligibility, benefits, and application processes all in one place.</p>
  </section>

  <section>
    <h2 class="translatable">How Our Website Helps</h2>
    <p class="translatable">
      We aim to bridge the information gap between the government and the public. Our platform:
    </p>
    <ul>
      <li class="translatable">Makes schemes searchable by name, ministry, or category</li>
      <li class="translatable">Provides short summaries and direct application links</li>
      <li class="translatable">Shows updates or new initiatives launched by the government</li>
      <li class="translatable">Empowers users to stay informed and take advantage of opportunities</li>
    </ul>
  </section>

  <section>
    <h2 class="translatable">Vision</h2>
    <p class="translatable">To ensure that every citizen is aware of the benefits and support available through
      government initiatives ‚Äî promoting inclusivity, growth, and progress.</p>
  </section>

  <footer>
    ¬© 2025 Government Schemes Portal | Designed to Inform and Empower
  </footer>

  <!-- Chatbot Button (Robot Icon) -->
  <div id="chatbot-btn" title="Chat with us">ü§ñ</div>
  <!-- Chatbot Popup -->
  <div id="chatbot-popup">
    <div id="chatbot-header">
      <span class="title">Chatbot</span>
      <span id="chatbot-maximize" title="Maximize">‚¨ú</span>
      <span id="chatbot-close" title="Close">&times;</span>
    </div>

    <div id="chatbot-chat-area"></div>
    <input id="chatbot-input" type="text" placeholder="Type your question...">
    <button id="chatbot-send">Send</button>
  </div>

  <script>
    // --- Chatbot popup open/close
    document.getElementById('chatbot-btn').onclick = function () {
      document.getElementById('chatbot-popup').style.display = 'block';
    };
    document.getElementById('chatbot-maximize').onclick = function () {
      window.open('chat_full.html', '_blank');
    };
    document.getElementById('chatbot-close').onclick = function () {
      document.getElementById('chatbot-popup').style.display = 'none';
    };

    // --- Chatbot Send Button (connected to Flask API)
    document.getElementById('chatbot-send').onclick = async function () {
      const input = document.getElementById('chatbot-input');
      const chatArea = document.getElementById('chatbot-chat-area');
      const userMsg = input.value.trim();
      if (!userMsg) return;

      // Show user's message
      chatArea.innerHTML += `<div style="color:#128c7e;margin-bottom:6px;"><b>üßë:</b> ${userMsg}</div>`;
      input.value = "";

      // Show loading
      const loadingDiv = document.createElement('div');
      loadingDiv.style.color = "#303030";
      loadingDiv.style.fontStyle = "italic";
      loadingDiv.textContent = "ü§ñ: Typing...";
      chatArea.appendChild(loadingDiv);
      chatArea.scrollTop = chatArea.scrollHeight;

      try {
        const response = await fetch('http://localhost:8501/chat', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ query: userMsg })
        });
        const data = await response.json();
        loadingDiv.textContent = `ü§ñ: ${data.answer}`;
        chatArea.scrollTop = chatArea.scrollHeight;
      } catch (error) {
        loadingDiv.textContent = "ü§ñ: Sorry, something went wrong!";
        console.error(error);
      }
    };

    // --- Language translation code
    const buttons = document.querySelectorAll('.lang-btn');
    const texts = document.querySelectorAll('.translatable');
    const LANG_CODES = { "en": "en", "hi": "hi", "te": "te", "mr": "mr", "kn": "kn", "ta": "ta" };
    texts.forEach(el => { el.dataset.original = el.textContent.trim(); });
    async function translateText(text, targetLang) {
      try {
        const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}`;
        const response = await fetch(url);
        const data = await response.json();
        if (data && data[0] && data[0][0] && data[0][0][0]) {
          return data[0][0][0];
        }
        return text;
      } catch (error) {
        console.error('Translation error:', error);
        return text;
      }
    }
    async function translateAll(targetLang) {
      const translations = [];
      for (let el of texts) {
        const originalText = el.dataset.original;
        const translated = await translateText(originalText, targetLang);
        translations.push(translated);
        await new Promise(resolve => setTimeout(resolve, 100));
      }
      return translations;
    }
    buttons.forEach(btn => {
      btn.addEventListener('click', async () => {
        const lang = btn.id.split('-')[0];
        if (btn.classList.contains('active')) return;
        buttons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        if (lang === "en") {
          texts.forEach(el => {
            el.textContent = el.dataset.original;
            el.classList.remove('loading');
          });
          return;
        }
        buttons.forEach(b => b.disabled = true);
        texts.forEach(el => { el.classList.add('loading'); });
        try {
          const targetLang = LANG_CODES[lang];
          const translations = await translateAll(targetLang);
          texts.forEach((el, i) => {
            el.textContent = translations[i];
            el.classList.remove('loading');
          });
        } catch (error) {
          console.error('Translation failed:', error);
          alert('Translation failed. Please try again.');
          texts.forEach(el => {
            el.textContent = el.dataset.original;
            el.classList.remove('loading');
          });
          buttons.forEach(b => b.classList.remove('active'));
          document.getElementById('en-btn').classList.add('active');
        } finally {
          buttons.forEach(b => b.disabled = false);
        }
      });
    });
  </script>
</body>

</html>